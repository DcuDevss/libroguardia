{% extends "base.html" %}

{% block title %}Nueva Comunicación{% endblock %}

{% block content %}
<div class="flex justify-center items-center min-h-screen bg-gray-100" x-data="{ showModal: false, showDropdown: false }">
    <div class="bg-white shadow-md rounded-lg p-6 w-full max-w-5xl mx-auto">
        <h1 class="text-2xl font-bold mb-4 text-center">Nueva Comunicación</h1>
        <form method="post">
            {% csrf_token %}
            <div class="grid gap-4 sm:grid-cols-3">
                <div class="sm:col-span-2">
                    <label for="inicio_guardia" class="block text-gray-700">Inicio Guardia:</label>
                    <input type="datetime-local" id="inicio_guardia" name="inicio_guardia" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-2">
                    <label for="finalizacion_guardia" class="block text-gray-700">Finalización Guardia:</label>
                    <input type="datetime-local" id="finalizacion_guardia" name="finalizacion_guardia" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1 relative">
                    <label for="encargado_guardia" class="block text-gray-700">Encargado Guardia:</label>
                    <select id="encargado_guardia" name="encargado_guardia" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                        {% for encargado in encargados %}
                        <option value="{{ encargado.id }}">{{ encargado.nombre_apellido }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="sm:col-span-1 relative">
                    <label for="personal_guardia" class="block text-gray-700">Personal Guardia:</label>
                    <div @click="showDropdown = !showDropdown" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3 cursor-pointer">
                        Seleccionar personal
                    </div>
                    <div x-show="showDropdown" @click.away="showDropdown = false" class="absolute mt-2 w-full bg-white border border-gray-300 rounded-lg shadow-lg z-10 p-4" style="display: none;">
                        <div class="grid grid-cols-3 gap-2">
                            {% for personal in personales %}
                            <label class="flex items-center p-2 hover:bg-gray-100">
                                <input type="checkbox" name="personal_guardia" value="{{ personal.id }}" class="form-checkbox" {% if personal.id in form.personal_guardia.value %}checked{% endif %}>
                                <span class="ml-2">{{ personal.nombre_apellido }}</span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="sm:col-span-1">
                    <label for="solicitante" class="block text-gray-700">Solicitante:</label>
                    <input type="text" id="solicitante" name="solicitante" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1">
                    <label for="nombre_apellido" class="block text-gray-700">Nombre y Apellido:</label>
                    <input type="text" id="nombre_apellido" name="nombre_apellido" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1">
                    <label for="dni" class="block text-gray-700">DNI:</label>
                    <input type="text" id="dni" name="dni" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1">
                    <label for="telefono" class="block text-gray-700">Teléfono:</label>
                    <input type="text" id="telefono" name="telefono" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1">
                    <label for="movil_patrulla" class="block text-gray-700">Móvil Patrulla:</label>
                    <input type="text" id="movil_patrulla" name="movil_patrulla" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-1">
                    <label for="personal_cargo" class="block text-gray-700">Personal a Cargo:</label>
                    <input type="text" id="personal_cargo" name="personal_cargo" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-3">
                    <label for="descripcion" class="block text-gray-700">Descripción:</label>
                    <textarea id="descripcion" name="descripcion" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" rows="4" required></textarea>
                </div>
                <div class="sm:col-span-1">
                    <label for="intervencion_comisaria" class="block text-gray-700">Intervención Comisaria:</label>
                    <input type="text" id="intervencion_comisaria" name="intervencion_comisaria" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-3" required>
                </div>
                <div class="sm:col-span-3">
                    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700 w-full">Guardar</button>
                </div>
            </div>
        </form>
        <a href="{% url 'divisioncomunicaciones_list' %}" class="mt-4 inline-block bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-700 w-full text-center">Volver a la lista</a>
    </div>
</div>
{% endblock %}
